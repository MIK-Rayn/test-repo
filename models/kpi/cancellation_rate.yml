version: 2

models:
  - name: cancellation_rate
    description: |
      The Cancellation Rate KPI measures the percentage of orders with cancellation requests. It leverages the CANCEL_REQUEST flag from the ORDER_HISTORY table to monitor potential issues in order fulfillment or customer satisfaction.
    columns:
      - name: cancellation_rate
        description: |
          The calculated KPI using the formula:
          (SUM(CASE WHEN ORDER_HISTORY.CANCEL_REQUEST = TRUE THEN 1 ELSE 0 END) / COUNT(ORDER_HISTORY.ID)) * 100
    meta:
      kpi_name: "Cancellation Rate"
      definition: "This measures the percentage of orders with cancellation requests (leveraging the cancel_request flag). Monitoring cancellations helps identify potential issues in order fulfillment or customer satisfaction."
      formula: "(SUM(CASE WHEN ORDER_HISTORY.CANCEL_REQUEST = TRUE THEN 1 ELSE 0 END) / COUNT(ORDER_HISTORY.ID)) * 100"
